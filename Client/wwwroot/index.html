<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MCC-MIS</title>
    <base href="/" />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="Client.styles.css" rel="stylesheet" />
    <link href="manifest.webmanifest" rel="manifest" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
</head>

<body>
    <div id="app">
        <div class="flex flex-col items-center justify-center min-h-screen bg-white dark:bg-gray-900">
            <img src="favicon.png" alt="App Icon" class="w-24 h-24 mb-8 rounded-lg" />
            <div class="relative flex items-center justify-center mb-4">
                <svg class="animate-spin h-10 w-10 text-[#839a83] dark:text-[#b2cdb2]" viewBox="0 0 50 50">
                    <circle
                        class="opacity-20"
                        cx="25"
                        cy="25"
                        r="20"
                        stroke="currentColor"
                        stroke-width="6"
                        fill="none"
                    />
                    <circle
                        class="opacity-80"
                        cx="25"
                        cy="25"
                        r="20"
                        stroke="currentColor"
                        stroke-width="6"
                        fill="none"
                        stroke-linecap="round"
                        stroke-dasharray="31.4 94.2"
                    />
                </svg>
            </div>            
            <!-- <div class="text-gray-600 dark:text-gray-300 text-md font-medium">Loading...</div> -->
        </div>
        <pwa-install 
            manifest-url="/manifest.webmanifest"
            name="MCC-MIS"
            description="Efficiently manage MCC logistics operations."
            icon="/icon-192.png"
            install-description="Want a smoother experience? Install MCC-MIS on your device to manage logistics anytime, anywhere!"
            use-local-storage="on">
        </pwa-install>

    </div>

    <!-- <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="." class="reload">Reload</a>
        <span class="dismiss">ðŸ—™</span>
    </div> -->
     <script>
        async function deleteAllCaches() {
            const cacheNames = await caches.keys();
            for (const cacheName of cacheNames) {
                await caches.delete(cacheName);
            }
        }
    </script>
    <script src="pwa-install.js"></script>
    <script src="installPrompt.js"></script>
    <script src="deviceDetection.js"></script>
    <script src="flowbite-interop.js"></script>
    <script src="exportHelper.js"></script>
    <script src="_framework/blazor.webassembly.js"></script>
    <script>navigator.serviceWorker.register('service-worker.js');</script>
    <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" async defer></script>
    <script>
        window.chartJsInterop = {
            charts: {},

            renderChart: function (canvasId, chartType, data, options) {
                const ctx = document.getElementById(canvasId).getContext('2d');

                // Destroy existing chart if it exists
                if (this.charts[canvasId]) {
                    this.charts[canvasId].destroy();
                }

                this.charts[canvasId] = new Chart(ctx, {
                    type: chartType,
                    data: data,
                    options: options
                });
            }
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        window.exportPdf = async (elementId, filename) => {
            const { jsPDF } = window.jspdf;
            const element = document.getElementById(elementId);
            const canvas = await html2canvas(element, { scale: 2 });
            const imgData = canvas.toDataURL("image/png");
            const pdf = new jsPDF("p", "mm", "a4");
            const imgProps = pdf.getImageProperties(imgData);
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
            pdf.addImage(imgData, "PNG", 0, 0, pdfWidth, pdfHeight);
            pdf.save(filename || "report.pdf");
        }
    </script>

</body>

</html>
